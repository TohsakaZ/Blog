**制约Linux操作系统实时性的原因**

Linux中有大量不可抢占的区域

在Linux2.6中,内核己经可以抢占,因而实时性得到了加强"但是内核中仍有大量的不可抢占区域,如由自旋锁(SPinlock)保护的临界区。

* 这里自旋锁之所以不能够抢占，目的是防止浪费其他内核线程因获取同样的锁导致空自选浪费时间片。而且有可能导致死锁，比如持有自旋锁的临界区

时钟粒度粗糙

Linux2.6内核虽然把时钟频率提高到1000 赫兹，定时精度达到了1ms，但远不能满足实时系统要求的微秒级定时精度，如数控系统要求50us 的定时精度。

关闭中断

系统调用和中断服务程序中，为了保护临界区资源,Linux会长时间关闭中断"有些系统调用和中断服务程序的时间还很长,这样会加大中断延迟时间。

缺乏有效的实时任务调度机制和调度算法

Linux系统是按照分时系统的目标设计的,以达到系统较好的平均性能，强调平衡各进程之间的响应时间来保证公平的CPU时间占用。通常采用固定时间片的分时调度算法，内核不能抢占，而实时系统的行为更多的取决于复杂的不可预知的情况。这些原则不能满足实时系统短的响应时间和确定的执行行为的要求。

优先级反转的问题

当一个低优先级的进程占用了某种资源，导致同样需要这个资源的高级进程无法运行，并且此时有一个优先级在他们之间的就绪进程获得了CPU 的控制权，这样就使得高级别的任务需要等待比他优先级别低的任务，这种现象就叫做优先级反转。在Linux中，由于资源是不可抢占的，并且不支持优先级继承等策略，所以优先级反转现象可能会发生，这影响了系统的实时性能。