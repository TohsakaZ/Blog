## **近期想要使用完成的一些事情**

九月

* [x] 整理ifcb源代码、文档

- [x] 完成测量平差、最优估计和最优化导论的整理
- [x] 实时轨道相关理论整理

十一月：

- [x] 将实现的SRIF搬到pod_Parallel分支

- [x] 优化SRIF中的求解效率
  1. 使用块QR分解，这里Eigen已经实现了（对比和其他Lapack库之间的效率？）
  2. 如何使用稀疏QR分解（虽然观测方程部分是稀疏矩阵，但是之前得到的信息方程阵已经是偏向于稠密了）
     1. 可以使用Eigen的稀疏QR分解
  
- [x] 整理预处理为三天的脚本，同时会拷贝数据文件到当前文件夹下  便于Windows下的计算

- [x] 测试状态转移后的精度（测试目前滤波的稳定性）

  1. 滤波测试内容（不包含质量控制），使用编辑残差后的3天log文件，测试3天弧段，进行轨道状态转移，以及积分状态转移

     主要目的：测试目前SRIF代码的正确性（包括量测更新、状态转移，积分转移），初步给出当前轨道的一个精度水平，同时作为后续测试的基准

     - [x] 测试时间2021 100-140
  
     - [x] 准备观测数据、广播星历等
  
     - [x] 进行单天的钟跳探测......doing

     - [x] 进行3d的周跳以及解算（为了得到编辑后的log文件）

       目前的问题主要是三天的tb为删除很多的测站，这里正在采用其他的测站列表进行尝试

     - [x] 进行SRIF滤波，统计后两天的精度，三天的收敛情况等

  2. 质量控制测试内容（包含质量控制、状态转移矩阵方差设置、积分步长）

     主要目的测试质量控制代码的稳定性，以及对比使用编辑log文件后，做质量控制能达到的一个精度水平。

     * [x] 测试新的QC方案的结果
     * [x] 测试参考钟为测站钟的情况
     
     目前2020、2021年分别测试了两天的算例，基本上采用1e-12、max_res 为5 能达到4-5cm这样的一个平均水平 收敛后的后两天，不过一般需要剔除两到三颗无法收敛的卫星。
     
  3. 2021年一个月的三天解的求解情况，主要测试目前质量控制方案
  
     * [x] 不同积分步长的影响
       * 初步测试没有太多影响
     * [x] 不同方差设置的影响 
       * 结果参考[记录](D:\code\Blog\source\_posts\GNSS\滤波轨道\滤波收敛噪声设置相关.md)
  
  #### 后续内容：多测站的时候效率、滤波质量控制、实时周跳探测、积分时段测试、**
  
- [x] 质量控制：SRIF粗差探测原理
  1. 搞懂残差更新原理
     1. 关于e表示了归一化后残差问题
     2. 关于直接估计误差值
     3. 利用3被sigma进行相关的判断
  2. 代码实现

- [x] 模糊度固定

  * 已增加双差模糊度固定代码
  * 正在测试模糊度固定效果：目前单历元模糊度固定效果还行

- [x] 评估非线性化误差对收敛时间以及精度方面的影响？

  * 对精度基本没有影响
  * 收敛时间粗略测试没有影响

- [x] 修复 pod脚本中进行质量控制的bug，

  目前bug主要由于第一次LSQ求解solve_neq部分失败，导致recover文件中得残差均为验前残差，导致pod进行质量控制失败（因为所有得残差都很大）

  而solve_neq求解失败得主要原因在于使用了Matrix_remove，**原因还未找到**，同时sigma也会因为matrix remove导致算的不对 

  目前发现也不是这个原因 但是openmp确实降低了残差质量

  目前通过改善脚本中质量控制部分，在不使用Matrix_remove情况下能够正常求解了 但matrix_remove的结果还是有点问题

  正常的数据质量下 single_remove和matrix_remove求解效果一致，数据质量差的情况下 single能够正常求解，但matrix的结果很差

  matrix_remove在加入固定解的时候求解效果很差 估计约束还是太大了= =

- [x] 测定超快和实时轨道需要计算得时间段 2021 100-300 选个10天吧

  目前基本基于OpenMP的matrix_remove和singleremove结果**基本一致**，一两天的块消参结果变差，估计是加固定解的时候求解的问题

  目前看来**125-139之间**的天块消参的结果不容易出错，后续在这个基础上做

- [x] G14、G18更新atx和sat_parameters_new后计算

  目前在pod_GREC_LSQ_openblas.ini下测试这个问题：125-139的天数

  目前暂时看起来没起作用，实在不行把BlockIII的卫星都删除了

  目前126之后的天 G14和G18基本由大幅度下降但是相较其他卫星还是大了1-2cm

- [x] 使用自带的周跳探测

  弄清现有的实时周跳探测算法原理过程，在实时滤波轨道中进行使用

  测试目前部分的基本使用

- [ ] 周跳和模糊度固定中MW计算的时间间隔  

  测试效果

  ~~实时边读边处理文件的模式有问题，以及读取文件过了需要的时间段后不会及时终止~~

  读取文件每次都是从头读，而且无法很好的处理跨天的情况

  ~~目前的单天的验证结果表明30s采样率的tb有精度上的提升，基本能接近使用初始tb文件的float结果~~ 

  现在貌似300s的结果就能接近logtb的结果了？？？？

  | 均为2020106算例       | 使用logtb的float结果 | 使用300s的litetbfloat结果 | 使用30s的litetb的float结果 |
  | --------------------- | -------------------- | ------------------------- | -------------------------- |
  | Win/ 90sites 15GPS    | 56                   | 54                        | 60                         |
  | Linux/90sites 15GPS   | 56                   | 53                        | 59                         |
  | Linux/120sites ALLGPS | 45                   | 48                        | 47                         |

  30s的结果目前貌似正常了一点，和300s结果基本类似，之前错误的原因看来主要是因为tb的采样间隔和处理的间隔时间不一致导致有些周跳没有在处理过程被探测出来

  

  ~~但是使用litetb似乎影响到了fix的求解问题~~

  对于fix而言 30s的款项对于模糊度固定而言有一定的提升

  | 均为2020106算例       | 使用logtb的300s的fix结果 | 使用logtb的30s的fix结果 | 使用300s的litetb的fix结果 | 使用30s的litetb的fix结果 |
  | --------------------- | ------------------------ | ----------------------- | ------------------------- | ------------------------ |
  | Win/ 90sites 15GPS    | 52                       | 51                      | 54                        | 60                       |
  | Linux/90sites 15GPS   | 48                       | 45                      | 53                        | 60                       |
  | Linux/120sites ALLGPS | 33                       | 30                      | 48                        |                          |

  **litetb和fix一起使用还是有点问题？**

  SRIF计算的脚本框架没什么问题，接下来就是把实验数据算好



- [ ] 固定解部分实验：

  * [x] 单系统G的 基于log_tb的float和fix（300s)的基本结果

  * ~~这里问题主要在于为什么2021年的fix提升那么的不明显 按照2020106的算例，相对于15颗星来说也有8mm的提升~~

  * 目前发现采用所有模糊度进行松约束的方式提升效果相较明显，但是一是感觉运算效率较慢，二是感觉这样引入了错误的模糊度固定集，还是希望通过选取独立模糊度集加上强约束的方式改善可能更为明显一点

  * 暂时使用这种方法进行计算多天的基于log_tb和ambfix的结果 如果ambfix结果好的话 就不测试其30s的结果了

    * [ ] 画图

  * 效果目前看起来比做紧约束的方式更好一点

  * 给出时序图、平均图以及表格统计

  * 模糊度固定率可以给一张图把 要记得备份debug.log的结果

    **准备画模糊度固定率**

  * [x] G的 IND约束的结果？重新改代码 

    算完了 结果文件为：orbdif_xxxx_COD_logtb_fix_ind_300s

  * [x] G的30s ALL约束的结果？简单测试一下没很大改善就不要重跑了

    **30s的ambfix很慢 找下原因**

    测试结果 改善了1mm，那暂时就不重算这部分数据了，**后面有时间再重算30s的固定解**

  * [x] E的浮点解和固定解

    * 处理CE的float结果和fix结果，作为相应的fix部分的固定结果（其中fix部分就采用事后log_tb、300s的方式）

      E11B  E12B  E13B  E15B E26B  E27A  E30A E33B E36B

      2021 125-130之间的Galileo卫星算不好

      现在正在跑2021 001 - 009之间的数据 
      
      **tab2 左边算clockrepair 算完了 tab2右边算prepare_tb 20个线程算完了**
      
      然后测试2021001这天的数据
      
      float 60cm 能接受把。。fix 39cm 提升还是比较显著的可以接受
      
      **tab4正在算E的浮点+固定解 基于logtb+QC fix为ALL 300s的解算方式**
      
      **已经算完 固定解结果还可以**

   * [x] C的浮点解和固定解
        然后跑一下BDS的float 和fix解
        
        直接算一发BDS2+BDS3的浮点+固定解
        
        float  8cm fix 7cm 能接受吧
        
        **tab5正在算126-135所有天的BDS固定解 计算中。。。。** 
        
   * [ ] 算一下基于GE和C单独的lite_tb+ambfix 30s的结果能算个三天的结果就不错了

        E算2020 001-003

        GC算2020 126-129的

        vscode正在算GC的因为GC的比较久 现在两部分的结果都跑起来了

- [x] 实时质量控制实验

  - [x] 126-135的10天的3d事后解 不用固定解 GCE三系统 **计算完**

  - [x] 然后基于该log_tb关闭质量控制跑一遍实时滤波解 单G的就好了 这两个都要测试其中一天的结果然后再跑多天的 

    ~~测试一下使用迭代后log文件的效果，且不开质量控制 得改下代码和脚本 在127上的算例测试一下结果不太好 考虑是否直接用初始log_tb+质量控制的方法进行替代~~

    结果不好的原因是没把正确的log文件拷贝过去，相当于算了最原始的log文件 

    目前用了正确的log文件结果稍微比使用log文件+QC的结果好一点，然后跑一下多天的结果 

    **等130天GEC三系统跑完 已完成**

  - [x] 然后基于实时质量控制算法跑一遍实时的滤波浮点解（直接开30s的吗还是300s的）那就都开一遍

    这里要测试一下 还是在2021126上先测试一下

    测试结果 基本两者之间相差5mm，基本认为精度水平相当（其之所以达不到事后检测精度主要认为是由于探测时，没有之后的信息造成的。

    算一下多天的数据结果，需要改一下脚本，然后将其中read_ofile_mode改为REALTIME 且interval为30s

    **已完成**

- [ ] 论文第三章 计算多天的实验（需不需要选取同一个天呢？？？暂时就不选取同一天了）

  > 计算时间暂定:2021 136-155
  >
  > 计算时间其实没必要那么长 就10-15天就好了126-140
  >
  > 然后最好选GCE都能算得天 而且算的是30s的间隔
  >
  > GCE的三天解还是要先算好（后面方便G、C、E在不同的文件夹中算）
  >
  > 那么其实先不用算GPS和BDS得重点先找到一个时间段是GAL可以一起算得
  >
  > 然后分别各算三天的结果 对比litetb(30s)+QC  logtbQC_fix_all_30 logtbQC_fix_ind_30的结果 再做进一步计算
  >
  > **tab6**正在算这三个系统的这三天的样例 确定算的结果
  >
  > 算了 E算的还是差 这样把还是按原来的数据集算 
  >
  > 把一些原来fix为300s的换成30s就好 然后就是所有系统都比较一下这两种方案

  * 首先是计算136-155的20天的3d事后解(主要需要其中的**初始ics文件和编辑后的log文件**)

    * [x] 下载观测数据（136-140）
    * [x] 计算3d解（非固定解) 只算到了140这一天

  * 首先有关litetb+QC和单log_tb结果的对比（用之前的结果就够了）

  * 然后是对比GPS的litetb+QC fix+IND fix+ALL的方案（测试一下litetbQC+fix的方案 不行就还是用原来的logtbQC+fix 采样率改成30s重跑）

    跑GPS的浮点解、固定解的DD-ALL和DD-IND的对比

    这三部分最好直接一起算就好了   算的有点问题（浮点解很差看下什么原因）是发生了重收敛

    问题原因在于用了单天的orbfit浮点解的结果，导致重新积分的时候严重偏离原来的轨道（那这个是不是说明轨道光压参数估计得很差）

    问题应该确认了就是ics天数问题，先暂时用三天得 后面跑多天得再解决一下这个问题

    确认下用litetb+fix还是logtb+fix 然后重跑30s的结果

    **tab4正在跑litetb+fix+IND的定轨结果 float结果是51**

    * [x] 浮点解 （litetb(30s)+QC）直接用之前的结果
    * [x] 浮点解（单logtb)  直接用之前的结果
    * [x] 固定解（log_tb+QC+fix_ind_30s)
    * [x] 固定解（log_tb+QC+fix_all_30s)

  * GAL浮点解和固定解的结果

    * [x] 准备数据  clock_repair算完了 tb也算完

    * [x] 浮点解 （log_tb+QC）直接用之前的结果

    跑个30s的固定解结果

    * [x] 固定解（log_tb+QC+fix_all_30s) 
    * [x] 固定解（log_tb+QC+fix_all_30s)

  * 跑BDS的log_tb+QC的浮点解和固定解的对比

    * [x] 浮点解 （log_tb+QC）直接用之前的结果

    跑个30s的固定解结果

    * [x] 固定解（log_tb+QC+fix_all_30s) 
    * [x] 固定解（log_tb+QC+fix_all_30s)

  目前结果都算完了 不过用fix_ind的解算结果很差，采用10E8的权进行相应的测试看下结果 结果是一样的 还是直接用1E8次方的权好了

论文内容：

**轨道精度部分**

同时再给一个和超快轨道比较的结果（如果结果不好还得比多个小时的。。。无语到了 说明问题（这里得写一个脚本） 需要重写orbdif的脚本和程序

还应该给一个SLR的结果（跑一个SLR的结果） 这个比较有可能

**轨道收敛部分**

同样给个和超快轨道对比的结果

**效率分析部分**

这里需要分别给出三系统更新之前，以及更新之后的轨道效率提升

一个说明轨道效率的总体提升比例，还有随时间变化的耗时图。

二个说明单历元的计算耗时可以满足10s的。

**PPP分析部分**

实验数据暂时得用001天的结果



- [ ] 论文第四章实验

  - [ ] OpenMP多线程并行实验
  - 这里还是要实现以下多线程的OI转移（现在都在单天的结果下测试成功就行）s
  - 重新计算多线程组方程优化耗时
  - 重新计算多线程preProcess优化耗时
  - [ ] QR分参数解算实验
  - 对比Eigen和Newmat的结果
  - 对比OpenBlas的结果
  - [ ] Ambfix的效率优化实验
  - 对比用SVD和最小生成树的结果
  - 对比用并行的结果
- [ ] 论文第五章实验

  - [ ] 多系统时间连续解算实验
  - 这里应该使用litetb+质量控制+ 模糊度固定的GCE多系统结果
  - 分析轨道精度、收敛效率、计算效率
  - 对比同样时间结点，预报产品的精度？
  - 使用计算出来的产品计算多测站进行PPP精度分析


下面两个就放弃了

* [ ] 测试实时数据流

- [ ] 扩展到多频
- [ ] 姿态异常？

***

**原理学习**

* [x] 模糊度固定、双差模糊度固定、LAMDA搜索原理
  * 
* [x] 粗差探测的假设检验
* [ ] 姿态相关概念
* [ ] OS相关内容
* [ ] 链接 库相关的内容
* [ ] CPP11 17 相关语法
* [ ] 矩阵相关内容 以及 Eigen的设计

***

**业余有时间再干**

- [ ] 实时操作系统，这个得看有没有机会接触嵌入式开发
- [ ] 熟悉Boost中的ASIO网络库，借此熟悉下基本网络知识和一些CPP11的语法
- [ ] 完成操作系统导论的课后练习，顺带整理下操作系统导论的相关笔记。

